estate_nobles_andal_strong_duchies = {
	icon = privilege_reform_progress
	max_absolutism = -10
	conditional_modifier = { trigger = { has_absolutism_reduction_for_estate_privileges = yes } modifier = { max_absolutism = 2 } }
	loyalty = 0.1
	influence = 0.1
	check_valid_when_tag_switching = no
	is_valid = {
		OR = {
			has_estate_privilege = estate_nobles_andal_strong_duchies
			AND = {
				tag = ARC
				NOT = { has_estate_privilege = estate_nobles_strong_duchies }
			}
		}
		any_subject_country = {
			OR = {
				is_subject_of_type = appanage
				is_subject_of_type = vassal
				is_subject_of_type = march
				is_subject_of_type = client_march
				is_subject_of_type = client_vassal
				is_subject_of_type = personal_union
				is_subject_of_type = incorporated_vassal
				is_subject_of_type = integrated_personal_union
			}
			capital_scope = { region = iberia_region }
			culture_group = iberian
		}
	}
	can_select = {
		custom_trigger_tooltip = {
			tooltip = estate_nobles_strong_duchies_trigger_tooltip
			calc_true_if = {
				amount = 2
				all_subject_country = {
					OR = {
						is_subject_of_type = appanage
						is_subject_of_type = vassal
						is_subject_of_type = march
						is_subject_of_type = client_march
						is_subject_of_type = client_vassal
						is_subject_of_type = personal_union
						is_subject_of_type = incorporated_vassal
						is_subject_of_type = integrated_personal_union
					}
				}
			}
		}
		NOT = { has_estate_privilege = estate_eunuchs_delegate_subject_diplomacy_privilege }
	}
    can_revoke = {
        NOT = { has_reform = andal_crown_reform }
    }
	penalties = {
        yearly_corruption = 0.1
	}
	benefits = {
		diplomatic_upkeep = 4
		vassal_manpower_bonus = 0.1
	}
	conditional_modifier = {
		trigger = { has_government_attribute = buffed_strong_duchies }
		modifier = {
			nobles_loyalty_modifier = 0.05
		}
	}
	ai_will_do = {
		factor = 2
		modifier = {
			factor = 3
			calc_true_if = {
				amount = 1
				all_subject_country = {
					OR = {
						is_march = yes
						is_vassal = yes
					}
				}
			}
		}
		modifier = {
			factor = 2
			calc_true_if = {
				amount = 2
				all_subject_country = {
					OR = {
						is_march = yes
						is_vassal = yes
					}
				}
			}
		}
	}
}

estate_burghers_tigranic_tolerance = {
	icon = privilege_tolerance_heretics
	max_absolutism = -5
	conditional_modifier = { trigger = { has_absolutism_reduction_for_estate_privileges = yes } modifier = { max_absolutism = 1 } }
	loyalty = 0.05
	influence = 0.05
	is_valid = {
		religion_group = christian
		NOT = { religion = tigranic }
	}
	conditional_modifier = {
		trigger = { has_country_flag = hun_empower_orthodox_autonomy }
		modifier = { max_absolutism = 5 church_loyalty_modifier = 0.1 }
	}
	can_select = {
		religion_group = christian
		NOT = { religion = tigranic }
		any_owned_province = {
			religion = tigranic
		}
	}
	on_granted = {
		if = {
			limit = { has_estate_privilege = estate_church_anti_heresy_act }
			remove_estate_privilege = estate_church_anti_heresy_act
			add_estate_loyalty = {
				estate = estate_church
				loyalty = -20
			}
		}
		custom_tooltip = estate_burghers_tigranic_tolerance_effect_tooltip
		hidden_effect = {
			set_country_flag = burghers_tolerates_tigranism
		}
	}
	on_granted_province = {
		if = {
			limit = {
				religion = tigranic
			}
			add_province_modifier = {
				name = estate_burghers_tigranic_autonomy_modifier
				duration = -1
			}
		}
		else_if = {
			limit = {
				has_province_modifier = estate_burghers_tigranic_autonomy_modifier
			}
			remove_province_modifier = estate_burghers_tigranic_autonomy_modifier
		}
	}
	on_revoked = {
		custom_tooltip = estate_burghers_tigranic_tolerance_revoke_effect_tooltip
		hidden_effect = {
			clr_country_flag = burghers_tolerates_tigranism
		}
	}
	on_revoked_province = {
		if = {
			limit = {
				has_province_modifier = estate_burghers_tigranic_autonomy_modifier
			}
			remove_province_modifier = estate_burghers_tigranic_autonomy_modifier
		}
	}
	on_invalid = {
		custom_tooltip = estate_burghers_tigranic_tolerance_revoke_effect_tooltip
		hidden_effect = {
			clr_country_flag = burghers_tolerates_tigranism
		}
	}
	on_invalid_province = {
		if = {
			limit = {
				has_province_modifier = estate_burghers_tigranic_autonomy_modifier
			}
			remove_province_modifier = estate_burghers_tigranic_autonomy_modifier
		}
	}
	penalties = {
		church_loyalty_modifier = -0.1
	}
	benefits = {
	}
	ai_will_do = {
		factor = 1000
		modifier = {
			factor = 0
			NOT = {
				any_owned_province = {
					religion = tigranic
				}
			}
		}
		modifier = {
			factor = 0
			government = theocracy
		}
		modifier = {
			factor = 0
			is_subject = yes
			overlord = {
				religion = ROOT
				has_idea_group = religious_ideas
			}
		}
	}
}