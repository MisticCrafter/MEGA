namespace = pirate_elections

country_event = {
	id = pirate_elections.1
	title = "pirate_elections.1.t"
	picture = BUCCANEERS_eventPicture
	desc = {
		trigger = {
			NOT = { has_country_flag = pirate_death_election }
			NOT = { has_country_flag = pirate_mutineer_council }
		}
		desc = "pirate_elections.1.desc"
	}
	desc = {
		trigger = {
			has_country_flag = pirate_death_election
		}
		desc = "pirate_elections.1.desc2"
	}
	desc = {
		trigger = {
			has_country_flag = pirate_mutineer_council
		}
		desc = "pirate_elections.1.desc3"
	}
	
	is_triggered_only = yes
	
	trigger = {
		has_government_attribute = is_pirate_republic_reform
		if = {
			limit = {
				has_country_flag = pirate_mutineer_council
			}
			republican_tradition = 50
		}
	}
	option = { # Current ruler
		name = "pirate_elections.1.keep"
		trigger = {
			has_regency = no
			NOT = { has_country_flag = pirate_death_election }
		}
		ai_chance = { 
			factor = 60
			modifier = {
				factor = 0
				NOT = { republican_tradition = 25 }
			}	
			modifier = {
				factor = 0.5
				NOT = { republican_tradition = 50 }
			}				
			modifier = {
				factor = 0.5
				NOT = { republican_tradition = 75 }
			}	
			modifier = {
				factor = 2.0
				republican_tradition = 90
			}		
		}
		custom_tooltip = remains_ruler
		if = {
			limit = {
				OR = {
					ruler_has_personality = legendary_pirate_personality
					has_ruler_flag = historical_pirate
				}
			}
			custom_tooltip = historical_pirate_tooltip
		}
		if = {
			limit = { has_government_attribute = reelection_increases_absolutism }
			tooltip = {
				add_absolutism = 10
			}
			custom_tooltip = ADD_ABSOLUTISM_BASED_ON_ELECTION_TERM
			hidden_effect = {
				for_variable_amount = {
					variable = election_term
					effect = "
						add_absolutism = 10
					"
				}
			}
			hidden_effect = {
				change_variable = {
					which = election_term
					value = 1
				}
			}
		}
		change_adm = 1
		change_dip = 1
		change_mil = 1
		if = {
			limit = {
				NOT = { has_ruler_flag = historical_pirate }
				NOT = { ruler_has_personality = legendary_pirate_personality }
			}
			if = {
				limit = {
					has_country_flag = increased_election_cost
				}
				add_scaled_republican_tradition = -15
				clr_country_flag = increased_election_cost
			}
			else = {
				add_scaled_republican_tradition = -10
			}
		}
		if = {
			limit = {
				faction_in_power = pr_buccaneers 
			}
			add_faction_influence = {
				faction = pr_buccaneers
				influence = -10
			}	
		}
		random_list = {
			10 = {
				add_adm_power = 50
			}
			10 = {
				add_dip_power = 50
			}
			10 = {
				add_mil_power = 50
			}
		}
		add_karma = -5
	}
	option = { # Buccaneer candidate
		name = "pirate_elections.1.a"
		ai_chance = { factor = 20 }
		if = {
			limit = { has_active_policy = mandatory_service }
			define_ruler = {
				mil = 1
				adm = 4
				dip = 1
				random_gender = yes # Allows random gender for republics
			}
		}
		else = {
			define_ruler = {
				mil = 1
				adm = 4
				dip = 1					
			}
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_adm_faction = {
				influence = 20
			}
		}
		add_karma = 10
	}
	option = { # Smugglers candidate
		name = "pirate_elections.1.b"
		ai_chance = { factor = 20 }
		if = {
			limit = { has_active_policy = mandatory_service }
			define_ruler = {
				dip = 4
				adm = 1
				mil = 1					
				random_gender = yes # Allows random gender for republics
			}
		}
		else = {
			define_ruler = {
				dip = 4
				adm = 1
				mil = 1					
			}
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_dip_faction = {
				influence = 20
			}
		}
		add_karma = 10
	}
	option = { # Captains candidate
		name = "pirate_elections.1.c"
		ai_chance = { factor = 20 }
		if = {
			limit = { has_active_policy = mandatory_service }
			define_ruler = {
				mil = 4
				adm = 1
				dip = 1					
				random_gender = yes # Allows random gender for republics
			}
		}
		else = {
			define_ruler = {
				mil = 4
				adm = 1
				dip = 1					
			}
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_mil_faction = {
				influence = 20
			}
		}
		add_karma = 10
	}
	option = { # Blackbeard!
		name = "pirate_elections.1.d"
		ai_chance = { factor = 1000 }
		trigger = {
			NOT = { has_global_flag = blackbeard_flag }
			is_year = 1700
			NOT = { is_year = 1720 }
			capital_scope = {
				region = carribeans_region
			}
		}
		define_ruler = {
			name = "Edward 'Blackbeard' Teach"
			adm = 3
			dip = 3
			mil = 6
			culture = english
		}
		if = {
			limit = {
				has_spare_flagship_capacity = yes
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_flagship = {	
					name = "Queen Anne's Revenge"
					type = heavy_ship
				}
			}
		}
		else_if = {
			limit = {
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_named_ship = {
					name = "Queen Anne's Revenge"
					type = heavy_ship
				}
			}
		}
		custom_tooltip = historical_pirate_tooltip
		set_ruler_flag = historical_pirate
		add_ruler_personality = legendary_pirate_personality
		set_global_flag = blackbeard_flag
	}
	option = { # Calico Jack
		name = "pirate_elections.1.e"
		ai_chance = { factor = 500 }
		trigger = {
			NOT = { has_global_flag = calico_jack }
			is_year = 1702
			NOT = { is_year = 1720 }
			capital_scope = {
				region = carribeans_region
			}
		}
		define_ruler = {
			name = "'Calico' Jack Rackham"
			adm = 2
			dip = 4
			mil = 4
			culture = english
		}
		if = {
			limit = {
				has_spare_flagship_capacity = yes
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_flagship = {	
					name = "Kingston"
					type = heavy_ship
				}
			}
		}
		else_if = {
			limit = {
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_named_ship = {
					name = "Kingston"
					type = heavy_ship
				}
			}
		}
		custom_tooltip = historical_pirate_tooltip
		set_ruler_flag = historical_pirate
		add_ruler_personality = legendary_pirate_personality
		set_global_flag = calico_jack
	}
	option = { # Anne Bonny
		name = "pirate_elections.1.f"
		ai_chance = { factor = 500 }
		trigger = {
			NOT = { has_global_flag = anne_bonny }
			is_year = 1716
			NOT = { is_year = 1782 }
			capital_scope = {
				region = carribeans_region
			}
		}
		define_ruler = {
			name = "Anne Bonny"
			adm = 4
			dip = 2
			mil = 5
			culture = irish
			female = yes
		}
		if = {
			limit = {
				has_spare_flagship_capacity = yes
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_flagship = {	
					name = "William"
					type = heavy_ship
				}
			}
		}
		else_if = {
			limit = {
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_named_ship = {
					name = "William"
					type = heavy_ship
				}
			}
		}
		custom_tooltip = historical_pirate_tooltip
		set_ruler_flag = historical_pirate
		add_ruler_personality = legendary_pirate_personality
		set_global_flag = anne_bonny
	}
	option = { # Mary Read
		name = "pirate_elections.1.g"
		ai_chance = { factor = 500 }
		trigger = {
			NOT = { has_global_flag = mary_read }
			is_year = 1703
			NOT = { is_year = 1721 }
			capital_scope = {
				region = carribeans_region
			}
		}
		define_ruler = {
			name = "Mary Read"
			adm = 3
			dip = 3
			mil = 5
			culture = english
			female = yes
		}
		custom_tooltip = historical_pirate_tooltip
		set_ruler_flag = historical_pirate
		add_ruler_personality = legendary_pirate_personality
		set_global_flag = mary_read
	}
	option = { # Charles Vane
		name = "pirate_elections.1.h"
		ai_chance = { factor = 500 }
		trigger = {
			NOT = { has_global_flag = charles_vane }
			is_year = 1702
			NOT = { is_year = 1720 }
			capital_scope = {
				region = carribeans_region
			}
		}
		define_ruler = {
			name = "Charles Vane"
			adm = 2
			dip = 3
			mil = 5
			culture = english
		}
		if = {
			limit = {
				has_spare_flagship_capacity = yes
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_flagship = {	
					name = "Ranger"
					type = heavy_ship
				}
			}
		}
		else_if = {
			limit = {
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_named_ship = {
					name = "Ranger"
					type = heavy_ship
				}
			}
		}
		custom_tooltip = historical_pirate_tooltip
		set_ruler_flag = historical_pirate
		add_ruler_personality = legendary_pirate_personality
		set_global_flag = charles_vane
	}
	option = { # Black Caesar
		name = "pirate_elections.1.i"
		ai_chance = { factor = 500 }
		trigger = {
			NOT = { has_global_flag = black_caesar }
			is_year = 1702
			NOT = { is_year = 1720 }
			capital_scope = {
				region = carribeans_region
			}
		}
		define_ruler = {
			name = "Black Caesar"
			adm = 4
			dip = 3
			mil = 5
			culture = yorumba
		}
		custom_tooltip = historical_pirate_tooltip
		set_ruler_flag = historical_pirate
		add_ruler_personality = legendary_pirate_personality
		set_global_flag = black_caesar
	}
	option = { # Ching Shih
		name = "pirate_elections.1.j"
		ai_chance = { factor = 500 }
		trigger = {
			NOT = { has_global_flag = ching_shih }
			is_year = 1795
			capital_scope = {
				OR = {
					superregion = east_indies_superregion
					superregion = china_superregion
					superregion = far_east_superregion
				}
			}
		}
		define_ruler = {
			name = "Ching Shih"
			adm = 5
			dip = 5
			mil = 6
			culture = cantonese
			female = yes
		}
		if = {
			limit = {
				has_spare_flagship_capacity = yes
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_flagship = {	
					name = "Red Flag"
					type = heavy_ship
				}
			}
		}
		else_if = {
			limit = {
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_named_ship = {
					name = "Red Flag"
					type = heavy_ship
				}
			}
		}
		custom_tooltip = historical_pirate_tooltip
		set_ruler_flag = historical_pirate
		add_ruler_personality = legendary_pirate_personality
		set_global_flag = ching_shih
	}
	option = { # Jack Ward
		name = "pirate_elections.1.k"
		ai_chance = { factor = 500 }
		trigger = {
			NOT = { has_global_flag = jack_ward }
			is_year = 1605
			NOT = { is_year = 1610 }
			capital_scope = {
				region = maghreb_region
			}
		}
		define_ruler = {
			name = "Jack Ward"
			adm = 3
			dip = 3
			mil = 5
			culture = english
		}
		if = {
			limit = {
				has_spare_flagship_capacity = yes
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_flagship = {	
					name = "Gift"
					type = heavy_ship
				}
			}
		}
		else_if = {
			limit = {
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_named_ship = {
					name = "Gift"
					type = heavy_ship
				}
			}
		}
		custom_tooltip = historical_pirate_tooltip
		set_ruler_flag = historical_pirate
		add_ruler_personality = legendary_pirate_personality
		set_global_flag = jack_ward
	}
	option = { # Laurens de Graaf
		name = "pirate_elections.1.l"
		ai_chance = { factor = 500 }
		trigger = {
			NOT = { has_global_flag = laurens_de_graaf }
			is_year = 1682
			NOT = { is_year = 1704 }
			capital_scope = {
				region = carribeans_region
			}
		}
		define_ruler = {
			name = "Laurens de Graaf"
			adm = 2
			dip = 4
			mil = 5
			culture = dutch
		}
		if = {
			limit = {
				has_spare_flagship_capacity = yes
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_flagship = {	
					name = "Tigre"
					type = heavy_ship
				}
			}
		}
		else_if = {
			limit = {
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_named_ship = {
					name = "Tigre"
					type = heavy_ship
				}
			}
		}
		custom_tooltip = historical_pirate_tooltip
		set_ruler_flag = historical_pirate
		add_ruler_personality = legendary_pirate_personality
		set_global_flag = laurens_de_graaf
	}
	option = { # Michel de Grammont
		name = "pirate_elections.1.m"
		ai_chance = { factor = 500 }
		trigger = {
			NOT = { has_global_flag = michel_de_gramont }
			is_year = 1670
			NOT = { is_year = 1686 }
			capital_scope = {
				region = carribeans_region
			}
		}
		define_ruler = {
			name = "Michel de Grammont"
			adm = 3
			dip = 3
			mil = 5
			culture = cosmopolitan_french
		}
		if = {
			limit = {
				has_spare_flagship_capacity = yes
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_flagship = {	
					name = "Hardi"
					type = heavy_ship
				}
			}
		}
		else_if = {
			limit = {
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_named_ship = {
					name = "Hardi"
					type = heavy_ship
				}
			}
		}
		custom_tooltip = historical_pirate_tooltip
		set_ruler_flag = historical_pirate
		add_ruler_personality = legendary_pirate_personality
		set_global_flag = michel_de_gramont
	}
	option = { # Pieter Pietersen Heyn
		name = "pirate_elections.1.n"
		ai_chance = { factor = 500 }
		trigger = {
			NOT = { has_global_flag = piet_hein }
			is_year = 1607
			NOT = { is_year = 1629 }
			primary_culture = dutch
		}
		define_ruler = {
			name = "Piet Heyn"
			adm = 3
			dip = 4
			mil = 5
			culture = dutch
		}
		if = {
			limit = {
				has_spare_flagship_capacity = yes
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_flagship = {	
					name = "Hollandia"
					type = heavy_ship
				}
			}
		}
		else_if = {
			limit = {
				capital_scope = {
					has_port = yes
				}
			}
			capital_scope = {
				create_named_ship = {
					name = "Hollandia"
					type = heavy_ship
				}
			}
		}
		custom_tooltip = historical_pirate_tooltip
		set_ruler_flag = historical_pirate
		add_ruler_personality = legendary_pirate_personality
		set_global_flag = piet_hein
	}
	option = { # Grace O'Malley
		name = "pirate_elections.1.o"
		ai_chance = { factor = 500 }
		trigger = {
			NOT = { has_global_flag = grace_omalley_flag }
			NOT = { has_global_flag = wih_grainnenimhaille_flag }
			is_year = 1530
			NOT = { is_year = 1605 }
			primary_culture = irish
		}
		custom_tooltip = historical_pirate_tooltip
		set_ruler_flag = historical_pirate
		add_ruler_personality = legendary_pirate_personality
		set_global_flag = grace_omalley_flag
		country_event = { id = women_history_events.22 }
	}
	option = { # François l'Olonnais
		name = "pirate_elections.1.p"
		ai_chance = { factor = 500 }
		trigger = {
			NOT = { has_global_flag = francois_olonnais }
			is_year = 1650
			NOT = { is_year = 1669 }
			capital_scope = {
				region = carribeans_region
			}
		}
		define_ruler = {
			name = "François l'Olonnais"
			adm = 3
			dip = 1
			mil = 5
			culture = cosmopolitan_french
		}
		custom_tooltip = historical_pirate_tooltip
		set_ruler_flag = historical_pirate
		add_ruler_personality = legendary_pirate_personality
		set_global_flag = francois_olonnais
	}
	after = {
		clr_country_flag = pirate_death_election
		clr_country_flag = pirate_mutineer_council
	}
}

country_event = {
	id = pirate_elections.2
	title = "pirates_elections.2.t"
	picture = BUCCANEERS_eventPicture
	desc = {
		trigger = {
			NOT = { has_country_flag = pirate_death_election }
			NOT = { has_country_flag = pirate_mutineer_council }
		}
		desc = "pirate_elections.2.desc"
	}
	desc = {
		trigger = {
			has_country_flag = pirate_death_election
		}
		desc = "pirate_elections.2.desc2"
	}
	desc = {
		trigger = {
			has_country_flag = pirate_mutineer_council
		}
		desc = "pirate_elections.2.desc3"
	}
	
	is_triggered_only = yes
	
	trigger = {
		has_government_attribute = is_pirate_republic_reform
		has_government_attribute = is_cynwyd_social_banditry_republic
		if = {
			limit = {
				has_country_flag = pirate_mutineer_council
			}
			republican_tradition = 50
		}
	}
	option = { # Current ruler
		name = "pirate_elections.2.keep"
		trigger = {
			has_regency = no
			NOT = { has_country_flag = pirate_death_election }
			OR = {
				NOT = { has_government_attribute = has_limited_terms }
				AND = {
					ruler_has_personality = legendary_pirate_personality
					NOT = {
						has_ruler_flag = is_legendary_cynwyd_captain
					}
				}
				check_variable = {
					which = max_election_term
					which = election_term
				}
			}
		}
		ai_chance = { 
			factor = 60
			modifier = {
				factor = 0
				NOT = { republican_tradition = 25 }
			}	
			modifier = {
				factor = 0.5
				NOT = { republican_tradition = 50 }
			}				
			modifier = {
				factor = 0.5
				NOT = { republican_tradition = 75 }
			}	
			modifier = {
				factor = 2.0
				republican_tradition = 90
			}		
		}
		custom_tooltip = remains_ruler
		if = {
			limit = {
				has_government_attribute = has_limited_terms
				NOT = { ruler_has_personality = legendary_pirate_personality }
			}
			custom_tooltip = current_term_tt
		}
		if = {
			limit = {
				OR = {
					ruler_has_personality = legendary_pirate_personality
					has_ruler_flag = historical_pirate
				}
			}
			custom_tooltip = historical_pirate_tooltip
		}
		if = {
			limit = { has_government_attribute = reelection_increases_absolutism }
			tooltip = {
				add_absolutism = 10
			}
			custom_tooltip = ADD_ABSOLUTISM_BASED_ON_ELECTION_TERM
			hidden_effect = {
				for_variable_amount = {
					variable = election_term
					effect = "
						add_absolutism = 10
					"
				}
			}
			hidden_effect = {
				change_variable = {
					which = election_term
					value = 1
				}
			}
		}
		change_adm = 1
		change_dip = 1
		change_mil = 1
		if = {
			limit = {
				NOT = { has_ruler_flag = historical_pirate }
				NOT = { ruler_has_personality = legendary_pirate_personality }
			}
			if = {
				limit = {
					has_country_flag = increased_election_cost
				}
				add_scaled_republican_tradition = -15
				clr_country_flag = increased_election_cost
			}
			else = {
				add_scaled_republican_tradition = -10
			}
		}
		if = {
			limit = {
				faction_in_power = pr_buccaneers 
			}
			add_faction_influence = {
				faction = pr_buccaneers
				influence = -10
			}	
		}
		random_list = {
			10 = {
				add_adm_power = 50
			}
			10 = {
				add_dip_power = 50
			}
			10 = {
				add_mil_power = 50
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				change_variable = {
					which = election_term
					value = 1
				}
			}
		}
	}
	option = { # Buccaneer candidate
		name = "pirate_elections.2.a"
		ai_chance = { factor = 20 }
		if = {
			limit = { has_active_policy = mandatory_service }
			define_ruler = {
				mil = 1
				adm = 4
				dip = 1
				random_gender = yes # Allows random gender for republics
			}
		}
		else = {
			define_ruler = {
				mil = 1
				adm = 4
				dip = 1					
			}
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_adm_faction = {
				influence = 20
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = adm
			}
		}
		
	}
	option = { # Smugglers candidate
		name = "pirate_elections.2.b"
		ai_chance = { factor = 20 }
		if = {
			limit = {
				has_active_policy = mandatory_service
				has_government_attribute = cynwyd_smugglers_empowered_elections
		}
			define_ruler = {
				dip = 4
				adm = 1
				mil = 1					
				random_gender = yes # Allows random gender for republics
			}
			clear_scripted_personalities = yes
			add_ruler_personality = fierce_negotiator_personality
			add_ruler_personality = entrepreneur_personality
		}
		if = {
			limit = {
				has_government_attribute = cynwyd_smugglers_empowered_elections
			}
			define_ruler = {
				dip = 4
				adm = 1
				mil = 1
			}
			clear_scripted_personalities = yes
			add_ruler_personality = fierce_negotiator_personality
			add_ruler_personality = entrepreneur_personality
		}
		if = {
			limit = { has_active_policy = mandatory_service }
			define_ruler = {
				dip = 4
				adm = 1
				mil = 1					
				random_gender = yes # Allows random gender for republics
			}
		}
		else = {
			define_ruler = {
				dip = 4
				adm = 1
				mil = 1					
			}
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_dip_faction = {
				influence = 20
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = dip
			}
		}
	}
	option = { # Captains candidate
		name = "pirate_elections.2.c"
		ai_chance = { factor = 20 }
		if = {
			limit = {
				has_active_policy = mandatory_service
				has_government_attribute = legendary_cynwyd_captains_elections
			}
			define_ruler = {
				mil = 4
				adm = 1
				dip = 1					
				random_gender = yes # Allows random gender for republics
			}
			clear_scripted_personalities = yes
			add_ruler_personality = legendary_pirate_personality
			set_ruler_flag = is_legendary_cynwyd_captain
		}
		if = {
			limit = {
				has_government_attribute = legendary_cynwyd_captains_elections
			}
			define_ruler = {
				mil = 4
				adm = 1
				dip = 1	
			}
			clear_scripted_personalities = yes
			add_ruler_personality = legendary_pirate_personality
			set_ruler_flag = is_legendary_cynwyd_captain
		}
		if = {
			limit = { has_active_policy = mandatory_service }
			define_ruler = {
				mil = 4
				adm = 1
				dip = 1					
				random_gender = yes # Allows random gender for republics
			}
		}
		else = {
			define_ruler = {
				mil = 4
				adm = 1
				dip = 1					
			}
		}
		if = {
			limit = { has_government_attribute = elections_increase_factions_influence }
			add_influence_to_mil_faction = {
				influence = 20
			}
		}
		if = {
			limit = {
				has_government_attribute = has_limited_terms
			}
			hidden_effect = {
				set_variable = {
					which = election_term
					value = 1
				}
			}
		}
		if = {
			limit = { has_government_attribute = has_candidate_bonus }
			assign_ruler_focus = {
				type = mil
			}
		}
	}
	
	after = {
		clr_country_flag = pirate_death_election
		clr_country_flag = pirate_mutineer_council
	}
}